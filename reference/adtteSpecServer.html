<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Module Server for ADTTE Specification — adtteSpecServer • teal.modules.hermes</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Module Server for ADTTE Specification — adtteSpecServer" />
<meta property="og:description" content="
This defines the server part for the ADTTE specification. The resulting data
set binned_adtte_subset contains the subset of ADTTE selected by the time-to-event
endpoint, joined together with the gene information extracted from specified assay
and experiment, as numeric and factor columns. The factor column is created by binning
the numeric column according to the quantile cutoffs specified in probs." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">teal.modules.hermes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/insightsengineering/teal.modules.hermes">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Module Server for ADTTE Specification</h1>
    <small class="dont-index">Source: <a href='https://github.com/insightsengineering/teal.modules.hermes/blob/master/R/adtteSpec.R'><code>R/adtteSpec.R</code></a></small>
    <div class="hidden name"><code>adtteSpecServer.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='https://lifecycle.r-lib.org/articles/stages.html#experimental'><img src='figures/lifecycle-experimental.svg' alt='[Experimental]' /></a></p>
<p>This defines the server part for the ADTTE specification. The resulting data
set <code>binned_adtte_subset</code> contains the subset of ADTTE selected by the time-to-event
endpoint, joined together with the gene information extracted from specified assay
and experiment, as numeric and factor columns. The factor column is created by binning
the numeric column according to the quantile cutoffs specified in <code>probs</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>adtteSpecServer</span><span class='op'>(</span>
  <span class='va'>id</span>,
  <span class='va'>datasets</span>,
  <span class='va'>mae_name</span>,
  <span class='va'>adtte_name</span>,
  <span class='va'>adtte_vars</span>,
  <span class='va'>experiment_data</span>,
  <span class='va'>experiment_name</span>,
  <span class='va'>assay</span>,
  <span class='va'>genes</span>,
  <span class='va'>probs</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>id</th>
      <td><p>(<code>string</code>)<br />
the ID used to call the teal module's UI function.</p></td>
    </tr>
    <tr>
      <th>datasets</th>
      <td><p>(<code>Datasets</code>)<br />
teal specific argument which is automatically passed to the UI and server
functions, holding all the data sets provided in the app initialization.</p></td>
    </tr>
    <tr>
      <th>mae_name</th>
      <td><p>(<code>string</code>)<br />
name of the MAE data used in the teal module.</p></td>
    </tr>
    <tr>
      <th>adtte_name</th>
      <td><p>(<code>string</code>)<br />
name of the ADTTE dataset.</p></td>
    </tr>
    <tr>
      <th>adtte_vars</th>
      <td><p>(named <code>list</code> of <code>string</code>)<br />
names of the variables to use in the ADTTE dataset. It should comprise elements:</p><ul>
<li><p><code>aval</code>: the numeric time-to-event variable.</p></li>
<li><p><code>avalu</code>: the variable holding the unit of <code>aval</code>.</p></li>
<li><p><code>is_event</code>: the logical event variable. It needs to be <code>TRUE</code>
when there was an observed event, and <code>FALSE</code> if the time is censored without
observed event.</p></li>
<li><p><code>paramcd</code>: the character or factor parameter code variable, defining the
type of time-to-event for selection in the module.</p></li>
<li><p><code>usubjid</code>: the subject ID variable.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>experiment_data</th>
      <td><p>(reactive <code>AnyHermesData</code>)<br /> input experiment.</p></td>
    </tr>
    <tr>
      <th>experiment_name</th>
      <td><p>(reactive <code>string</code>)<br /> name of the input experiment.</p></td>
    </tr>
    <tr>
      <th>assay</th>
      <td><p>(reactive <code>string</code>)<br /> name of the assay.</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>(reactive <code>GeneSpec</code>)<br /> gene specification.</p></td>
    </tr>
    <tr>
      <th>probs</th>
      <td><p>(reactive <code>numeric</code>)<br /> probabilities to bin the gene or gene signature
into.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List with the following elements:</p><ul>
<li><p><code>binned_adtte_subset</code>: reactive containing the joined ADTTE and gene data.</p></li>
<li><p><code>gene_col</code>: reactive containing the string with the column name of the original
numeric gene variable.</p></li>
<li><p><code>gene_factor</code>: string with the variable name for the binned gene data.</p></li>
<li><p><code>time_unit</code>: reactive string with the time unit for the current subset.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='adtteSpecInput.html'>adtteSpecInput()</a></code> for the module UI.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>ui</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>id</span>,
               <span class='va'>datasets</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>ns</span> <span class='op'>&lt;-</span> <span class='fu'>NS</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span>

  <span class='fu'>teal.devel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/teal.devel/man/standard_layout.html'>standard_layout</a></span><span class='op'>(</span>
    encoding <span class='op'>=</span> <span class='fu'>div</span><span class='op'>(</span>
      <span class='fu'><a href='experimentSpecInput.html'>experimentSpecInput</a></span><span class='op'>(</span><span class='fu'>ns</span><span class='op'>(</span><span class='st'>"experiment"</span><span class='op'>)</span>, datasets <span class='op'>=</span> <span class='va'>datasets</span>, mae_name <span class='op'>=</span> <span class='st'>"MAE"</span><span class='op'>)</span>,
      <span class='fu'><a href='assaySpecInput.html'>assaySpecInput</a></span><span class='op'>(</span><span class='fu'>ns</span><span class='op'>(</span><span class='st'>"assay"</span><span class='op'>)</span><span class='op'>)</span>,
      <span class='fu'><a href='geneSpecInput.html'>geneSpecInput</a></span><span class='op'>(</span><span class='fu'>ns</span><span class='op'>(</span><span class='st'>"genes"</span><span class='op'>)</span>, funs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Mean <span class='op'>=</span> <span class='va'>colMeans</span><span class='op'>)</span><span class='op'>)</span>,
      <span class='fu'><a href='adtteSpecInput.html'>adtteSpecInput</a></span><span class='op'>(</span><span class='fu'>ns</span><span class='op'>(</span><span class='st'>"adtte"</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>)</span>,
    output <span class='op'>=</span> <span class='fu'>verbatimTextOutput</span><span class='op'>(</span><span class='fu'>ns</span><span class='op'>(</span><span class='st'>"summary"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>server</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span>,
                   <span class='va'>output</span>,
                   <span class='va'>session</span>,
                   <span class='va'>datasets</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>experiment</span> <span class='op'>&lt;-</span> <span class='fu'><a href='experimentSpecServer.html'>experimentSpecServer</a></span><span class='op'>(</span>
    <span class='st'>"experiment"</span>,
    datasets <span class='op'>=</span> <span class='va'>datasets</span>,
    mae_name <span class='op'>=</span> <span class='st'>"MAE"</span>
  <span class='op'>)</span>
  <span class='va'>assay</span> <span class='op'>&lt;-</span> <span class='fu'><a href='assaySpecServer.html'>assaySpecServer</a></span><span class='op'>(</span>
    <span class='st'>"assay"</span>,
    assays <span class='op'>=</span> <span class='va'>experiment</span><span class='op'>$</span><span class='va'>assays</span>
  <span class='op'>)</span>
  <span class='va'>genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='geneSpecServer.html'>geneSpecServer</a></span><span class='op'>(</span>
    <span class='st'>"genes"</span>,
    funs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Mean <span class='op'>=</span> <span class='va'>colMeans</span><span class='op'>)</span>,
    gene_choices <span class='op'>=</span> <span class='va'>experiment</span><span class='op'>$</span><span class='va'>genes</span>
  <span class='op'>)</span>
  <span class='va'>adtte</span> <span class='op'>&lt;-</span> <span class='fu'>adtteSpecServer</span><span class='op'>(</span>
    <span class='st'>"adtte"</span>,
    datasets <span class='op'>=</span> <span class='va'>datasets</span>,
    adtte_name <span class='op'>=</span> <span class='st'>"ADTTE"</span>,
    mae_name <span class='op'>=</span> <span class='st'>"MAE"</span>,
    adtte_vars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
      aval <span class='op'>=</span> <span class='st'>"AVAL"</span>,
      avalu <span class='op'>=</span> <span class='st'>"AVALU"</span>,
      is_event <span class='op'>=</span> <span class='st'>"is_event"</span>,
      paramcd <span class='op'>=</span> <span class='st'>"PARAMCD"</span>,
      usubjid <span class='op'>=</span> <span class='st'>"USUBJID"</span>
    <span class='op'>)</span>,
    experiment_data <span class='op'>=</span> <span class='va'>experiment</span><span class='op'>$</span><span class='va'>data</span>,
    experiment_name <span class='op'>=</span> <span class='va'>experiment</span><span class='op'>$</span><span class='va'>name</span>,
    assay <span class='op'>=</span> <span class='va'>assay</span>,
    genes <span class='op'>=</span> <span class='va'>genes</span>,
    probs <span class='op'>=</span> <span class='fu'>reactive</span><span class='op'>(</span><span class='op'>{</span><span class='fl'>0.5</span><span class='op'>}</span><span class='op'>)</span>
  <span class='op'>)</span>
  <span class='va'>output</span><span class='op'>$</span><span class='va'>summary</span> <span class='op'>&lt;-</span> <span class='fu'>renderPrint</span><span class='op'>(</span><span class='op'>{</span>
    <span class='va'>binned_adtte_subset</span> <span class='op'>&lt;-</span> <span class='va'>adtte</span><span class='op'>$</span><span class='fu'>binned_adtte_subset</span><span class='op'>(</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>binned_adtte_subset</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>my_app</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mae</span> <span class='op'>&lt;-</span> <span class='fu'>hermes</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/hermes/man/multi_assay_experiment.html'>multi_assay_experiment</a></span>
  <span class='va'>adtte</span> <span class='op'>&lt;-</span> <span class='fu'>scda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/scda/man/synthetic_cdisc_data.html'>synthetic_cdisc_data</a></span><span class='op'>(</span><span class='st'>"rcd_2021_07_07"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adtte</span> <span class='op'>%&gt;%</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>is_event <span class='op'>=</span> <span class='va'>.data</span><span class='op'>$</span><span class='va'>CNSR</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span>

  <span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>teal_data</span><span class='op'>(</span>
    <span class='fu'>dataset</span><span class='op'>(</span>
      <span class='st'>"ADTTE"</span>,
      <span class='va'>adtte</span>,
      code <span class='op'>=</span> <span class='st'>'adtte &lt;- scda::synthetic_cdisc_data("rcd_2021_07_07")$adtte %&gt;%
        dplyr::mutate(is_event = .data$CNSR == 0)'</span>
    <span class='op'>)</span>,
    <span class='fu'>dataset</span><span class='op'>(</span><span class='st'>"MAE"</span>, <span class='va'>mae</span><span class='op'>)</span>
  <span class='op'>)</span>

  <span class='va'>app</span> <span class='op'>&lt;-</span> <span class='fu'>init</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>data</span>,
    modules <span class='op'>=</span> <span class='fu'>root_modules</span><span class='op'>(</span>
      <span class='fu'>module</span><span class='op'>(</span>
        label <span class='op'>=</span> <span class='st'>"adtteSpec example"</span>,
        server <span class='op'>=</span> <span class='va'>server</span>,
        ui <span class='op'>=</span> <span class='va'>ui</span>,
        filters <span class='op'>=</span> <span class='st'>"all"</span>
      <span class='op'>)</span>
    <span class='op'>)</span>
  <span class='op'>)</span>
  <span class='fu'>shinyApp</span><span class='op'>(</span><span class='va'>app</span><span class='op'>$</span><span class='va'>ui</span>, <span class='va'>app</span><span class='op'>$</span><span class='va'>server</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>my_app</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by NEST.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


